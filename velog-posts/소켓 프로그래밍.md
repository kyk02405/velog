<hr />
<h1 id="μ†μΌ“μ-κ°λ…-1">μ†μΌ“μ κ°λ… 1</h1>
<p>β€Ά μ „ν™” ν†µμ‹ κ³Ό μ†μΌ“ ν†µμ‹  λΉ„κµ</p>
<p><img alt="" src="https://velog.velcdn.com/images/kyk02405/post/e5bc73b2-e831-4465-8ef9-c281e6c658b6/image.png" /></p>
<hr />
<h1 id="μ†μΌ“μ-κ°λ…-2">μ†μΌ“μ κ°λ… 2</h1>
<p><img alt="" src="https://velog.velcdn.com/images/kyk02405/post/4cbe9bc6-c372-4f3f-80d3-bb8c8c661b32/image.png" /></p>
<hr />
<h1 id="μ†μΌ“μ-κ°λ…-3">μ†μΌ“μ κ°λ… 3</h1>
<ul>
<li>μ†μΌ“μ μ •μ<ul>
<li>μ†μΌ“μ€ 1982λ…„ BSD(Berkeley Software Distribution) UNIX 4.1μ—μ„ μ²μ μ†κ°λμ—κ³ , ν„μ¬ λ„λ¦¬
μ‚¬μ©λλ” κ²ƒμ€ 1986λ…„ BSD UNIX 4.3μ—μ„ κ°μ •λ κ²ƒ</li>
<li>μ†μΌ“μ€ μ†ν”„νΈμ›¨μ–΄λ΅ μ‘μ„±λ ν†µμ‹  μ ‘μ†μ </li>
<li>μ†μΌ“μ€ μ‘μ©ν”„λ΅κ·Έλ¨μ—μ„ TCP/IPλ¥Ό μ΄μ©ν•λ” μ°½κµ¬(μΈν„°νμ΄μ¤) μ—­ν• </li>
<li>μ£Όλ΅ TCP μƒμ—μ„ λ™μ‘ν•λ” μ†μΌ“μ„ μ‚¬μ©ν•΄μ„ β€TCP μ†μΌ“β€
λλ” β€TCP/IP μ†μΌ“β€ μ΄λΌκ³  ν•¨</li>
<li>λ¬Όλ΅ , UDP μ†μΌ“λ„ κ°€λ¥</li>
</ul>
</li>
</ul>
<p><img alt="" src="https://velog.velcdn.com/images/kyk02405/post/14e70e9b-d181-4bbe-93a6-55b053efae44/image.png" /></p>
<hr />
<h1 id="socket-vs-websocket-λΉ„κµν‘">Socket vs WebSocket λΉ„κµν‘</h1>
<table>
<thead>
<tr>
<th>νΉμ§•</th>
<th>Socket</th>
<th>WebSocket</th>
</tr>
</thead>
<tbody><tr>
<td>ν”„λ΅ν† μ½ λ λ²¨</td>
<td>TCP/IP μ €μμ¤€</td>
<td>HTTP κΈ°λ° κ³ μμ¤€</td>
</tr>
<tr>
<td>λΌμ΄λΈλ¬λ¦¬</td>
<td>νμ΄μ¬ κΈ°λ³Έ λ‚΄μ¥ (socket)</td>
<td>μ™Έλ¶€ λΌμ΄λΈλ¬λ¦¬ ν•„μ” (websockets)</td>
</tr>
<tr>
<td>μ—°κ²° λ°©μ‹</td>
<td>μ–‘λ°©ν–¥ ν†µμ‹  (Full-duplex)</td>
<td>μ–‘λ°©ν–¥ ν†µμ‹  (Full-duplex)</td>
</tr>
<tr>
<td>μ£Όμ” μ©λ„</td>
<td>μΌλ° λ„¤νΈμ›ν¬ ν†µμ‹ , μ„λ²„-μ„λ²„ ν†µμ‹ </td>
<td>μ›Ή κΈ°λ° μ‹¤μ‹κ°„ ν†µμ‹ </td>
</tr>
<tr>
<td>κµ¬ν„ λ°©μ‹</td>
<td>λ™κΈ°/λΉ„λ™κΈ° λ¨λ‘ κ°€λ¥</td>
<td>μ£Όλ΅ λΉ„λ™κΈ°(async/await)</td>
</tr>
<tr>
<td>λ³΄μ•</td>
<td>κΈ°λ³Έμ μΈ TCP/IP λ³΄μ•</td>
<td>TLS/SSL μ§€μ› (WSS)</td>
</tr>
<tr>
<td>λΈλΌμ°μ € μ§€μ›</td>
<td>μ§μ ‘ μ‚¬μ© λ¶κ°€</td>
<td>λ€λ¶€λ¶„μ ν„λ€ λΈλΌμ°μ € μ§€μ›</td>
</tr>
<tr>
<td>μ΄κΈ° μ—°κ²°</td>
<td>TCP ν•Έλ“μ…°μ΄ν¬</td>
<td>HTTP μ—…κ·Έλ μ΄λ“ (WS ν•Έλ“μ…°μ΄ν¬)</td>
</tr>
<tr>
<td>μ‚¬μ© μ‚¬λ΅€</td>
<td>- λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²°<br />- λ„¤νΈμ›ν¬ μ„λΉ„μ¤<br />- μ‹μ¤ν… κ°„ ν†µμ‹ </td>
<td>- μ›Ή μ±„ν…<br />- μ‹¤μ‹κ°„ κ²μ„<br />- μ‹¤μ‹κ°„ λ°μ΄ν„° μ¤νΈλ¦¬λ°</td>
</tr>
<tr>
<td>μ„¤μΉ ν•„μ”μ„±</td>
<td>λ¶ν•„μ” (λ‚΄μ¥)</td>
<td>ν•„μ” (pip install websockets)</td>
</tr>
<tr>
<td>ν¬νΈ μ‚¬μ©</td>
<td>λ¨λ“  ν¬νΈ μ‚¬μ© κ°€λ¥</td>
<td>μ£Όλ΅ 80(WS)/443(WSS) ν¬νΈ μ‚¬μ©</td>
</tr>
<tr>
<td>λ°©ν™”λ²½ ν†µκ³Ό</td>
<td>μ¶”κ°€ μ„¤μ • ν•„μ”ν•  μ μμ</td>
<td>μΌλ°μ μΌλ΅ μ©μ΄ (HTTP κΈ°λ°)</td>
</tr>
<tr>
<td>μ—λ¬ μ²λ¦¬</td>
<td>μλ™ κµ¬ν„ ν•„μ”</td>
<td>λ‚΄μ¥ μ—λ¬ μ²λ¦¬ λ©”μ»¤λ‹μ¦</td>
</tr>
</tbody></table>
<hr />
<h1 id="μ†μΌ“μ„-ν†µν•-googlecom-μ ‘μ†">μ†μΌ“μ„ ν†µν• google.com μ ‘μ†</h1>
<p><img alt="" src="https://velog.velcdn.com/images/kyk02405/post/14ca595a-b622-4053-92aa-2f40de049eba/image.png" /></p>
<hr />
<h1 id="googlecom-μ ‘μ†-μ‹¤μµ">google.com μ ‘μ† (μ‹¤μµ)</h1>
<pre><code class="language-python">import socket  # socket λ¨λ“ μ„ν¬νΈ (μ €μμ¤€ λ„¤νΈμ›ν¬ ν†µμ‹ μ„ μ„ν• ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬)

#### 1λ²μ§Έ λ°©λ²• ####

# μ†μΌ“ κ°μ²΄ μƒμ„± (IPv4 μ£Όμ† μ²΄κ³„, TCP ν†µμ‹  λ°©μ‹)
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# κµ¬κΈ€ μ„λ²„μ 80λ² ν¬νΈμ— μ—°κ²° (HTTP κΈ°λ³Έ ν¬νΈ)
sock.connect((&quot;www.google.com&quot;, 80))

# HTTP GET μ”μ²­ μ „μ†΅ (κ°„λ‹¨ν &quot;GET \n&quot;λ§ λ³΄λƒ„ β€” μ‹¤μ  μ”μ²­μ€ λ” λ³µμ΅ν•¨)
sock.send(&quot;GET \n&quot;.encode())

# μ‘λ‹µ λ°μ΄ν„° 1024λ°”μ΄νΈ μμ‹ 
data = sock.recv(1024)

# μμ‹ ν• λ°μ΄ν„° μ¶λ ¥ (λ°”μ΄νΈ -&gt; λ¬Έμμ—΄λ΅ λ””μ½”λ”©)
print(data.decode())

# μ†μΌ“ μ—°κ²° μΆ…λ£
sock.close()


#### 2λ²μ§Έ λ°©λ²• ####

# withλ¬Έμ„ μ‚¬μ©ν•λ©΄ λΈ”λ΅μ΄ λλ‚  λ• μ†μΌ“μ΄ μλ™μΌλ΅ λ‹«ν (μμ› ν•΄μ  μλ™ μ²λ¦¬)
with socket.socket() as sock:
    # μ„λ²„ μ£Όμ† λ° ν¬νΈ μ •μ
    addr = (&quot;www.google.com&quot;, 80)

    # μ„λ²„ μ—°κ²°
    sock.connect(addr)

    # μ”μ²­ μ „μ†΅
    sock.send(&quot;GET \n&quot;.encode())

    # μ‘λ‹µ μμ‹ 
    data = sock.recv(1024)

    # μ‘λ‹µ μ¶λ ¥
    print(data.decode())</code></pre>
<hr />
<h3 id="π”Ή-μ†μΌ“-μƒμ">π”Ή μ†μΌ“ μƒμ</h3>
<ul>
<li><code>socket.AF_INET</code> : IPv4</li>
<li><code>socket.AF_INET6</code> : IPv6</li>
<li><code>socket.SOCK_STREAM</code> : TCP</li>
<li><code>socket.SOCK_DGRAM</code> : UDP</li>
</ul>
<hr />
<h3 id="π”Ή-with-λ¬Έ">π”Ή with λ¬Έ</h3>
<ul>
<li><code>with</code> λΈ”λ΅μ„ λ²—μ–΄λ‚λ©΄ μλ™μΌλ΅ <code>close()</code> μ‹¤ν–‰</li>
<li><code>with socket.socket() as sock</code>λ” <code>sock = socket.socket()</code> + <code>sock.close()</code>μ™€ λ™μΌ ν¨κ³Ό</li>
</ul>
<hr />
<h3 id="π”Ή-encode-λ©”μ†λ“">π”Ή encode() λ©”μ†λ“</h3>
<ul>
<li>λ¬Έμμ—΄μ„ byteλ΅ λ³€ν™ (μ „μ†΅ μ‹ ν•„μ)</li>
<li>λ°”μ΄νΈ ν•μ‹: <code>b&quot;...&quot;</code> λλ” <code>b'...'</code></li>
<li><code>bytes(&quot;ABC&quot;, &quot;utf-8&quot;)</code> β‰ <code>&quot;ABC&quot;.encode()</code></li>
<li><code>str</code>(λ¬Έμμ—΄)κ³Ό <code>bytes</code>(λ°”μ΄νΈ)λ” λ‹¤λ¦„</li>
</ul>
<hr />
<h1 id="μ†μΌ“-ν”„λ΅κ·Έλλ°-κµ¬μ΅°">μ†μΌ“ ν”„λ΅κ·Έλλ° κµ¬μ΅°</h1>
<p><img alt="" src="https://velog.velcdn.com/images/kyk02405/post/de3e4b15-ef9c-4884-9c2d-0f14bb0ec1d7/image.png" /></p>
<hr />
<h1 id="μ†μΌ“-ν”„λ΅κ·Έλλ°---μ„λ²„">μ†μΌ“ ν”„λ΅κ·Έλλ° - μ„λ²„</h1>
<p>μ•„λλ” μ—…λ΅λ“ν• μ½”λ“λ¥Ό νƒ€μ΄ν•‘ν•κ³ , κ° λ‹¨κ³„λ³„λ΅ μ£Όμ„μ„ μ¶”κ°€ν• λ²„μ „μ…λ‹λ‹¤:</p>
<pre><code class="language-python">import socket  # socket λ¨λ“ μ„ν¬νΈ

# 1. μ†μΌ“ μƒμ„± (IPv4, TCP)
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# 2. λ°”μΈλ”© (νΈμ¤νΈ μ£Όμ†λ” κ³µλ€μΌλ΅ λ¨λ“  μΈν„°νμ΄μ¤ ν—μ©, ν¬νΈλ” 9999λ΅ μ„¤μ •)
sock.bind((&quot;&quot;, 9999))

# 3. ν΄λΌμ΄μ–ΈνΈ μ ‘μ† λ€κΈ°
sock.listen()
print(&quot;The echo server start.....&quot;)

# 4. μ ‘μ† μλ½ (ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν•λ©΄ connκ³Ό addrμ— μ €μ¥λ¨)
conn, addr = sock.accept()

# 5. λ°μ΄ν„° μμ‹  (μµλ€ 1024λ°”μ΄νΈ μ½κΈ°)
read_data = conn.recv(1024)
print(&quot;recv &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; {}&quot;.format(read_data))

# 6. μ ‘μ† μΆ…λ£
conn.close()  # ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μΆ…λ£
sock.close()  # μ„λ²„ μ†μΌ“ μΆ…λ£</code></pre>
<hr />
<ul>
<li><p><strong><code>bind((IP, PORT))</code></strong></p>
<ul>
<li>μ„λ²„μ IPμ™€ ν¬νΈλ¥Ό μ§€μ •</li>
<li>IPμ— <code>&quot;&quot;</code> λλ” <code>&quot;0.0.0.0&quot;</code>μ„ μ…λ ¥ν•λ©΄ <strong>λ¨λ“  λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤μ—μ„ μ ‘μ† μμ‹ </strong> κ°€λ¥</li>
</ul>
</li>
<li><p><strong><code>listen(1)</code></strong></p>
<ul>
<li>μ„λ²„κ°€ <strong>λ™μ‹ μ ‘μ†μ„ λ‡ κ°κΉμ§€ ν—μ©</strong>ν• μ§€ μ„¤μ •</li>
<li><code>1</code>μ΄λ©΄ <strong>ν• κ°μ ν΄λΌμ΄μ–ΈνΈ μ ‘μ†λ§ ν—μ©</strong></li>
</ul>
</li>
<li><p><strong><code>accept()</code></strong></p>
<ul>
<li>ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν•λ©΄ **μƒλ΅μ΄ μ†μΌ“ κ°μ²΄(conn)**μ™€ **μ£Όμ† μ •λ³΄(addr)**λ¥Ό λ°ν™</li>
<li><code>conn</code>μ€ ν•΄λ‹Ή ν΄λΌμ΄μ–ΈνΈμ™€ ν†µμ‹ ν•  μ†μΌ“</li>
</ul>
</li>
</ul>
<hr />
<h1 id="μ†μΌ“-ν”„λ΅κ·Έλλ°---ν΄λΌμ΄μ–ΈνΈ">μ†μΌ“ ν”„λ΅κ·Έλλ° - ν΄λΌμ΄μ–ΈνΈ</h1>
<pre><code class="language-python">import socket  # socket λ¨λ“ μ„ν¬νΈ

# 1. μ†μΌ“ μƒμ„± (IPv4, TCP)
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# 2. μ„λ²„μ— μ ‘μ† μ‹λ„ (127.0.0.1: λ΅μ»¬νΈμ¤νΈ, ν¬νΈ 9999)
sock.connect((&quot;127.0.0.1&quot;, 9999))

# 3. λ°μ΄ν„° μ†΅μ‹  (μ‚¬μ©μ μ…λ ¥ β†’ bytes λ³€ν™ ν›„ μ „μ†΅)
send_data = input(&quot;μ…λ ¥: &quot;)
sock.sendall(bytes(send_data, &quot;utf-8&quot;))

# 4. μ ‘μ† μΆ…λ£
print(&quot;ν΄λΌμ΄μ–ΈνΈ μΆ…λ£!&quot;)
sock.close()</code></pre>
<hr />
<h3 id="π”Ή-send-vs-sendall">π”Ή <code>send()</code> vs <code>sendall()</code></h3>
<ul>
<li><p><strong><code>send()</code></strong></p>
<ul>
<li>Cμ–Έμ–΄ μ‹μ¤ν… μ½ κΈ°λ° <strong>μ €μμ¤€ λ©”μ†λ“</strong></li>
<li><strong>λ°μ΄ν„° μΌλ¶€λ§ μ „μ†΅</strong>λ  κ°€λ¥μ„± μμ</li>
<li>μ „μ†΅λ λ°”μ΄νΈ μλ¥Ό ν™•μΈν•κ³  λ°λ³µ μ²λ¦¬ν•΄μ•Ό ν•¨</li>
</ul>
</li>
<li><p><strong><code>sendall()</code></strong></p>
<ul>
<li>νμ΄μ¬μ <strong>κ³ μμ¤€ λ©”μ†λ“</strong></li>
<li><strong>λ²„νΌμ λ¨λ“  λ°μ΄ν„°κ°€ μ „μ†΅λ  λ•κΉμ§€ μλ™ μ²λ¦¬</strong></li>
<li>μ‚¬μ©μκ°€ μ „μ†΅ μ™„λ£ μ—¬λ¶€λ¥Ό μ‹ κ²½ μ“Έ ν•„μ” μ—†μ</li>
</ul>
</li>
</ul>
<blockquote>
<p>β… μΌλ°μ μΌλ΅ <code>sendall()</code> μ‚¬μ© κ¶μ¥</p>
</blockquote>
<hr />
<h1 id="μ—μ½”-μ„λ²„---ν΄λΌμ΄μ–ΈνΈ">μ—μ½” μ„λ²„ - ν΄λΌμ΄μ–ΈνΈ</h1>
<p><img alt="" src="https://velog.velcdn.com/images/kyk02405/post/97ecc42b-ca95-4161-844a-6e01d6fb4615/image.png" /></p>
<hr />
<h1 id="μ—μ½”-μ„λ²„-1-λ©”μ‹μ§€-1λ²-μ£Όκ³ -λ°›μ">μ—μ½” μ„λ²„ 1 (λ©”μ‹μ§€ 1λ² μ£Όκ³  λ°›μ)</h1>
<pre><code class="language-python">import socket  # socket λ¨λ“ μ„ν¬νΈ

# 1. μ†μΌ“ μƒμ„± (IPv4, TCP)
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# 2. λ°”μΈλ”© (λ¨λ“  IP ν—μ©, ν¬νΈ 9999)
sock.bind((&quot;&quot;, 9999))

# 3. ν΄λΌμ΄μ–ΈνΈ μ ‘μ† λ€κΈ°
sock.listen()
print(&quot;The echo server start.....&quot;)

# 4. ν΄λΌμ΄μ–ΈνΈ μ ‘μ† μλ½
conn, addr = sock.accept()

# 5-1. λ°μ΄ν„° μμ‹ 
read_data = conn.recv(1024)
print(&quot;recv &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; {}&quot;.format(read_data))

# 5-2. λ°μ΄ν„° μ†΅μ‹  (μμ‹ ν• λ°μ΄ν„°λ¥Ό κ·Έλ€λ΅ λ‹¤μ‹ μ „μ†΅ - μ—μ½”)
conn.sendall(read_data)
print(&quot;send &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; {}&quot;.format(read_data))

# 6. μ ‘μ† μΆ…λ£
conn.close()
sock.close()</code></pre>
<h3 id="β…-μ”μ•½-μ„¤λ…">β… μ”μ•½ μ„¤λ…:</h3>
<ul>
<li>μ΄ μ½”λ“λ” <strong>μ—μ½” μ„λ²„</strong>λ΅, ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ°μ΄ν„°λ¥Ό κ·Έλ€λ΅ λ‹¤μ‹ ν΄λΌμ΄μ–ΈνΈμ— λλ ¤λ³΄λƒ…λ‹λ‹¤.</li>
<li><code>conn.sendall(read_data)</code>λ” μμ‹ ν• λ°μ΄ν„°λ¥Ό κ·Έλ€λ΅ λλλ ¤λ³΄λ‚΄λ” λ™μ‘μ…λ‹λ‹¤.</li>
<li><code>sendall()</code> μ‚¬μ©μΌλ΅ <strong>μ „μ†΅ λ„λ½ μ—†μ΄ μ•μ •μ μΈ μ†΅μ‹ </strong>μ΄ κ°€λ¥ν•©λ‹λ‹¤.</li>
</ul>
<hr />
<h1 id="μ—μ½”-ν΄λΌμ΄μ–ΈνΈ-1-λ©”μ‹μ§€-1λ²-μ£Όκ³ -λ°›μ">μ—μ½” ν΄λΌμ΄μ–ΈνΈ 1 (λ©”μ‹μ§€ 1λ² μ£Όκ³  λ°›μ)</h1>
<pre><code class="language-python">import socket  # socket λ¨λ“ μ„ν¬νΈ (λ„¤νΈμ›ν¬ ν†µμ‹  κΈ°λ¥ μ κ³µ)

# 1. μ†μΌ“ μƒμ„± (IPv4 μ£Όμ† μ²΄κ³„, TCP ν”„λ΅ν† μ½)
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# 2. μ ‘μ† μ‹λ„ (127.0.0.1μ€ λ΅μ»¬νΈμ¤νΈ, ν¬νΈ 9999λ” μ„λ²„κ°€ μ—΄μ–΄λ‘” ν¬νΈ)
sock.connect((&quot;127.0.0.1&quot;, 9999))

# 3-1. λ°μ΄ν„° μ†΅μ‹ 
send_data = input(&quot;μ…λ ¥: &quot;)  # μ‚¬μ©μλ΅λ¶€ν„° λ©”μ‹μ§€ μ…λ ¥λ°›κΈ°
sock.sendall(bytes(send_data, &quot;utf-8&quot;))  # μ…λ ¥κ°’μ„ UTF-8λ΅ μΈμ½”λ”©ν•μ—¬ μ„λ²„λ΅ μ „μ†΅

# 3-2. λ°μ΄ν„° μμ‹ 
recv_data = sock.recv(1024)  # μ„λ²„λ΅λ¶€ν„° μµλ€ 1024λ°”μ΄νΈ λ°μ΄ν„° μμ‹ 
print(f&quot;recv : {recv_data}&quot;)  # μμ‹ ν• λ°μ΄ν„° μ¶λ ¥ (λ°”μ΄νΈ ν•νƒ)

# 4. μ ‘μ† μΆ…λ£
print(&quot;ν΄λΌμ΄μ–ΈνΈ μΆ…λ£!&quot;)  # μΆ…λ£ λ©”μ‹μ§€ μ¶λ ¥
sock.close()  # μ†μΌ“ μΆ…λ£ (μ—°κ²° ν•΄μ )</code></pre>
<hr />
<h3 id="β…-μ”μ•½">β… μ”μ•½:</h3>
<ul>
<li>μ΄ μ½”λ“λ” <strong>μ—μ½” μ„λ²„</strong>μ™€ ν†µμ‹ ν•λ” ν΄λΌμ΄μ–ΈνΈμ…λ‹λ‹¤.</li>
<li>μ‚¬μ©μκ°€ μ…λ ¥ν• λ°μ΄ν„°λ¥Ό μ„λ²„μ— λ³΄λ‚΄κ³ , μ„λ²„λ΅λ¶€ν„° <strong>κ·Έλ€λ΅ λ‹¤μ‹ λ°›μ€ λ°μ΄ν„°λ¥Ό μ¶λ ¥</strong>ν• ν›„ μΆ…λ£ν•©λ‹λ‹¤.</li>
<li><code>sendall()</code>κ³Ό <code>recv()</code>λ” κ°κ° μ•μ „ν• μ†΅μ‹ κ³Ό μμ‹ μ„ μ„ν• κΈ°λ³Έ λ©”μ†λ“μ…λ‹λ‹¤.</li>
</ul>
<hr />
<h1 id="μ—μ½”-μ„λ²„-2-λ©”μ‹μ§€-μ—¬λ¬-λ²-μ£Όκ³ -λ°›μ">μ—μ½” μ„λ²„ 2 (λ©”μ‹μ§€ μ—¬λ¬ λ² μ£Όκ³  λ°›μ)</h1>
<pre><code class="language-python">import socket  # socket λ¨λ“ μ„ν¬νΈ (λ„¤νΈμ›ν¬ ν†µμ‹ μ©)

# withλ¬Έ μ‚¬μ©: λΈ”λ΅μ΄ λλ‚λ©΄ μλ™μΌλ΅ μ†μΌ“ closeλ¨
with socket.socket() as s:
    s.bind((&quot;&quot;, 9999))  # λ¨λ“  IPμ—μ„ μ¤λ” μ—°κ²°μ„ 9999 ν¬νΈλ΅ λ°”μΈλ”©
    s.listen()  # ν΄λΌμ΄μ–ΈνΈ μ ‘μ† λ€κΈ° μƒνƒ μ§„μ…
    print(&quot;The echo server start.....&quot;)

    conn, addr = s.accept()  # ν΄λΌμ΄μ–ΈνΈ μ ‘μ† μλ½, connμ€ ν†µμ‹ μ© μ†μΌ“, addrμ€ μ£Όμ†

    # λ¬΄ν• λ°λ³µ: ν΄λΌμ΄μ–ΈνΈ λ©”μ‹μ§€λ¥Ό κ³„μ† μμ‹ ν•κ³  λ‹¤μ‹ μ „μ†΅
    while True:
        recv_data = conn.recv(1024)  # λ°μ΄ν„° μμ‹  (μµλ€ 1024λ°”μ΄νΈ)
        print(&quot;recv &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; {}&quot;.format(recv_data.decode()))  # μμ‹  λ°μ΄ν„° μ¶λ ¥

        # &quot;end&quot;λΌλ” λ¬Έμμ—΄μ΄ μμ‹ λλ©΄ λ°λ³µ μΆ…λ£
        if recv_data.decode() == &quot;end&quot;:
            break

        conn.sendall(recv_data)  # μμ‹  λ°μ΄ν„°λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² λ‹¤μ‹ μ „μ†΅ (μ—μ½”)
        print(&quot;send &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; {}&quot;.format(recv_data))  # μ „μ†΅ λ°μ΄ν„° μ¶λ ¥

print(&quot;echo complete..&quot;)  # μ„λ²„ μΆ…λ£ λ©”μ‹μ§€</code></pre>
<hr />
<h3 id="β…-μ”μ•½-μ„¤λ…-1">β… μ”μ•½ μ„¤λ…:</h3>
<ul>
<li>ν΄λΌμ΄μ–ΈνΈκ°€ <code>&quot;end&quot;</code>λ¥Ό λ³΄λ‚Ό λ•κΉμ§€ <strong>μ—μ½” μ„λ²„ κΈ°λ¥ λ°λ³µ μν–‰</strong></li>
<li><code>recv()</code> β†’ μμ‹ , <code>sendall()</code> β†’ μ—μ½” μ‘λ‹µ</li>
<li><code>with</code>λ¬Έ λ•λ¶„μ— μ†μΌ“ μλ™ μ •λ¦¬</li>
<li><code>conn.close()</code>λ” μƒλµλμ—μ§€λ§, <code>with</code>κ°€ λλ‚λ©΄ μ„λ²„ μ†μΌ“μ€ μ•μ „ν•κ² λ‹«ν.</li>
</ul>
<hr />
<h1 id="μ—μ½”-ν΄λΌμ΄μ–ΈνΈ-2-λ©”μ‹μ§€-μ—¬λ¬-λ²-μ£Όκ³ -λ°›μ">μ—μ½” ν΄λΌμ΄μ–ΈνΈ 2 (λ©”μ‹μ§€ μ—¬λ¬ λ² μ£Όκ³  λ°›μ)</h1>
<pre><code class="language-python">import socket  # socket λ¨λ“ μ„ν¬νΈ (λ„¤νΈμ›ν¬ ν†µμ‹  κΈ°λ¥ μ κ³µ)

# 1. μ†μΌ“ μƒμ„± (IPv4 μ£Όμ† μ²΄κ³„, TCP ν”„λ΅ν† μ½ μ‚¬μ©)
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# 2. μ„λ²„ μ ‘μ† μ‹λ„ (λ΅μ»¬νΈμ¤νΈ 127.0.0.1, ν¬νΈ 9999)
sock.connect((&quot;127.0.0.1&quot;, 9999))

# λ¬΄ν• λ£¨ν”„λ¥Ό ν†µν•΄ μ‚¬μ©μ μ…λ ¥μ„ λ°λ³µμ μΌλ΅ μ „μ†΅
while True:
    # 3-1. λ°μ΄ν„° μ†΅μ‹ 
    send_data = input(&quot;μ…λ ¥: &quot;)  # μ‚¬μ©μλ΅λ¶€ν„° μ…λ ¥λ°›κΈ°
    sock.sendall(bytes(send_data, &quot;utf-8&quot;))  # μ…λ ¥κ°’μ„ UTF-8λ΅ μΈμ½”λ”©ν•μ—¬ μ„λ²„λ΅ μ „μ†΅

    # μ‚¬μ©μκ°€ &quot;end&quot;λ¥Ό μ…λ ¥ν•λ©΄ λ£¨ν”„ μΆ…λ£
    if send_data == &quot;end&quot;:
        break

    # 3-2. λ°μ΄ν„° μμ‹  (μ„λ²„λ΅λ¶€ν„° μ—μ½” μ‘λ‹µ λ°›κΈ°)
    recv_data = sock.recv(1024)  # μµλ€ 1024λ°”μ΄νΈ μμ‹ 
    print(f&quot;recv : {recv_data}&quot;)  # μμ‹ ν• λ°μ΄ν„° μ¶λ ¥ (λ°”μ΄νΈν•)

# 4. μ ‘μ† μΆ…λ£
print(&quot;ν΄λΌμ΄μ–ΈνΈ μΆ…λ£!&quot;)  # μΆ…λ£ λ©”μ‹μ§€ μ¶λ ¥
sock.close()  # μ†μΌ“ μΆ…λ£ (μ—°κ²° ν•΄μ )</code></pre>
<hr />
<h3 id="β…-λ™μ‘-μ”μ•½">β… λ™μ‘ μ”μ•½:</h3>
<ul>
<li>μ‚¬μ©μκ°€ μ…λ ¥ν• λ°μ΄ν„°λ¥Ό μ„λ²„μ— λ³΄λ‚΄κ³ , μ„λ²„μ—μ„ λ‹¤μ‹ λλ ¤μ¤€ λ©”μ‹μ§€λ¥Ό μ¶λ ¥ν•λ” <strong>μ—μ½” ν΄λΌμ΄μ–ΈνΈ</strong>.</li>
<li><code>&quot;end&quot;</code>λ¥Ό μ…λ ¥ν•λ©΄ ν†µμ‹  μΆ…λ£ λ° μ†μΌ“ λ‹«ν.</li>
</ul>
<hr />
<h1 id="λ‹¤μ¤‘-ν΄λΌμ΄μ–ΈνΈ---μ“°λ λ“-ν™μ©">λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ - μ“°λ λ“ ν™μ©</h1>
<p><img alt="" src="https://velog.velcdn.com/images/kyk02405/post/89618ec4-465f-48a6-9314-cdc6e7c20f67/image.png" /></p>
<h3 id="π”Ή-μ†΅μμ‹ -μ²λ¦¬-κ°μ”">π”Ή μ†΅μμ‹  μ²λ¦¬ κ°μ”</h3>
<ul>
<li><strong>ν• λ€μ μ»΄ν“¨ν„°μ—μ„ μ†΅μμ‹ μ„ λ™μ‹μ— μ²λ¦¬</strong>ν•μ—¬ <strong>μ‹¤μ‹κ°„ μ–‘λ°©ν–¥ ν†µμ‹  κ°€λ¥</strong></li>
<li><strong>μ†΅μ‹  μ“°λ λ“</strong>: μ‚¬μ©μκ°€ μ…λ ¥ν• λ©”μ‹μ§€λ¥Ό μ„λ²„λ΅ μ „μ†΅</li>
<li><strong>μμ‹  μ“°λ λ“</strong>: μ„λ²„μ—μ„ μ¨ λ©”μ‹μ§€λ¥Ό μ‹¤μ‹κ°„μΌλ΅ λ°›μ•„ μ¶λ ¥</li>
</ul>
<hr />
<h3 id="π”Ή-μ„λ²„μ—μ„-ν΄λΌμ΄μ–ΈνΈ-μ—°κ²°-μ²λ¦¬">π”Ή μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μ²λ¦¬</h3>
<ul>
<li><strong>λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ</strong>λ¥Ό <strong>λ™μ‹μ— μ ‘μ† μ²λ¦¬ κ°€λ¥</strong></li>
<li>κ° ν΄λΌμ΄μ–ΈνΈλ” <strong>λ…λ¦½λ μ“°λ λ“</strong>μ—μ„ λ™μ‘
β†’ ν΄λΌμ΄μ–ΈνΈλ§λ‹¤ λ³„λ„ ν†µμ‹  μ²λ¦¬ κ°€λ¥</li>
</ul>
<hr />
<h3 id="π”Ή-μ£Όμμ‚¬ν•­-μ‹¤λ¬΄-μ°Έκ³ μ©">π”Ή μ£Όμμ‚¬ν•­ (μ‹¤λ¬΄ μ°Έκ³ μ©)</h3>
<ul>
<li><strong>μ“°λ λ“ λ™κΈ°ν™” ν•„μ”</strong>
β†’ κ³µμ  μμ› μ ‘κ·Ό μ‹ <code>Lock</code> μ‚¬μ© κ¶μ¥</li>
<li><strong>μμ™Έ μ²λ¦¬ ν•„μ</strong>
β†’ λ„¤νΈμ›ν¬ μ¤λ¥, ν΄λΌμ΄μ–ΈνΈ λΉ„μ •μƒ μΆ…λ£ λ“± λ€λΉ„</li>
</ul>
<hr />
<h1 id="μ“°λ λ“-μ‹¤μµ">μ“°λ λ“ μ‹¤μµ</h1>
<pre><code class="language-python">import threading  # νμ΄μ¬ μ“°λ λ”© λ¨λ“ μ„ν¬νΈ
import time       # μ‹κ°„ μ§€μ—°μ„ μ„ν• λ¨λ“

# μ²« λ²μ§Έ μ“°λ λ“κ°€ μ‹¤ν–‰ν•  ν•¨μ
def thread1():
    for i in range(5):
        print(&quot;thread1 ++++++++&quot;)
        time.sleep(0.1)  # 0.1μ΄ λ€κΈ°

# λ‘ λ²μ§Έ μ“°λ λ“κ°€ μ‹¤ν–‰ν•  ν•¨μ
def thread2():
    for i in range(5):
        print(&quot;thread2 ========&quot;)
        time.sleep(0.1)  # 0.1μ΄ λ€κΈ°

# μ“°λ λ“ κ°μ²΄ μƒμ„± (κ° ν•¨μ μ§€μ •)
th1 = threading.Thread(target=thread1)
th2 = threading.Thread(target=thread2)

# μ“°λ λ“ μ‹μ‘
th1.start()
th2.start()

# μ“°λ λ“κ°€ λλ‚  λ•κΉμ§€ λ€κΈ° (join μ—†μΌλ©΄ main END λ¨Όμ € μ¶λ ¥λ  μ μμ)
th1.join()
th2.join()

# λ¨λ“  μ“°λ λ“κ°€ μΆ…λ£λ ν›„ μ¶λ ¥
print(&quot;main END!&quot;)  # μ£Ό μ“°λ λ“ μΆ…λ£ λ©”μ‹μ§€</code></pre>
<hr />
<h3 id="π”Ή-ν”„λ΅μ„Έμ¤--μ“°λ λ“-κΈ°λ³Έ-κ°λ…">π”Ή ν”„λ΅μ„Έμ¤ &amp; μ“°λ λ“ κΈ°λ³Έ κ°λ…</h3>
<ul>
<li><strong>ν”„λ΅μ„Έμ¤</strong>: μ‹¤ν–‰ μ¤‘μΈ ν”„λ΅κ·Έλ¨ (λ©”λ¨λ¦¬μ— μ¬λΌκ°€ λ…λ¦½μ μΌλ΅ λ™μ‘)</li>
<li>ν•λ‚μ ν”„λ΅μ„Έμ¤λ” <strong>μµμ† ν•λ‚ μ΄μƒμ μ“°λ λ“</strong>λ¥Ό ν¬ν•¨</li>
<li><span style="color: red;"><strong>λ©€ν‹°μ“°λ λ“</strong></span>: OS μ¤μΌ€μ¤„λ¬κ°€ μ—¬λ¬ μ“°λ λ“λ¥Ό λ²κ°μ•„ μ‹¤ν–‰ν•΄ <strong>λ™μ‹ μν–‰μ²λΌ λ³΄μ΄κ² ν•¨</strong></li>
<li><span style="color: lightgreen;">μ‹¤ν–‰ν•  λ•λ§λ‹¤ <strong>μ¤μΌ€μ¤„λ§ μμ„κ°€ λ‹¬λΌμ Έ κ²°κ³Όλ„ λ‹¬λΌμ§ μ μμ</strong></li>
</ul>
<h3 id="π”Ή-join-ν•¨μ-μ—­ν• ">π”Ή <code>join()</code> ν•¨μ μ—­ν• </h3>
<ul>
<li><strong><code>join()</code></strong>: ν•΄λ‹Ή μ“°λ λ“κ°€ <strong>μ™„μ „ν λλ‚  λ•κΉμ§€</strong> λ©”μΈ μ“°λ λ“κ°€ <strong>κΈ°λ‹¤λ¦¬κ² ν•¨</strong></li>
<li>μ΄λ¥Ό ν†µν•΄ <strong>μΆ€λΉ„ ν”„λ΅μ„Έμ¤(μΆ…λ£λμ§€ μ•μ€ μ“°λ λ“)</strong> λ°μƒ λ°©μ§€</li>
<li>ν”„λ΅κ·Έλ¨μ <strong>μ •μƒ μΆ…λ£λ¥Ό λ³΄μ¥</strong></li>
</ul>
<h3 id="β…-ν•µμ‹¬-ν¬μΈνΈ">β… ν•µμ‹¬ ν¬μΈνΈ</h3>
<ul>
<li><code>thread1()</code>κ³Ό <code>thread2()</code>λ” κ°κ° λ³„λ„μ μ“°λ λ“μ—μ„ μ‹¤ν–‰λ¨</li>
<li><code>start()</code>λ΅ μ“°λ λ“ μ‹¤ν–‰, <code>join()</code>μΌλ΅ μ™„λ£ λ€κΈ°</li>
<li><code>join()</code>μ΄ μ—†μΌλ©΄ <code>main END!</code>κ°€ λ¨Όμ € μ¶λ ¥λ  μ μμ
β†’ <strong>λ™μ‹μ„± ν…μ¤νΈ/λ™μ‘ ν™•μΈμ© κΈ°λ³Έ μμ </strong>λ΅ μ ν•©</li>
</ul>
<hr />
<h1 id="μƒμ†-μ¤λ²„λΌμ΄λ”©-μ‹¤μµ">μƒμ†, μ¤λ²„λΌμ΄λ”© μ‹¤μµ</h1>
<pre><code class="language-python"># λ¶€λ¨ ν΄λμ¤ dad μ •μ
class dad():
    def dad_look(self):
        print(&quot;handsome&quot;)  # μ•„λΉ  μ™Έλ¨ μ¶λ ¥

    def doYouKonw(self, lec):  # μΌλ°μ μΈ μ§λ¬Έ μ‘λ‹µ λ©”μ†λ“
        print(f&quot;I don't know {lec}&quot;)

# λ¶€λ¨ ν΄λμ¤ mom μ •μ
class mom():
    def mom_look(self):
        print(&quot;pretty&quot;)  # μ—„λ§ μ™Έλ¨ μ¶λ ¥

# μμ‹ ν΄λμ¤ child1: dadμ™€ momμ„ λ‹¤μ¤‘ μƒμ†
class child1(dad, mom):  # μƒμ†λ§ ν•κ³  λ‚΄μ© μ—†μ
    pass

# μμ‹ ν΄λμ¤ child2: dadμ™€ momμ„ λ‹¤μ¤‘ μƒμ† + λ©”μ„λ“ μ¤λ²„λΌμ΄λ”©
class child2(dad, mom):
    def doYouKonw(self, lec):  # μ¤λ²„λΌμ΄λ”© (λ¶€λ¨ λ©”μ†λ“ μ¬μ •μ)
        print(f&quot;I love {lec}&quot;)

# child1 κ°μ²΄ μƒμ„± λ° λ¶€λ¨ λ©”μ†λ“ μ‚¬μ©
c1 = child1()
c1.dad_look()     # β†’ &quot;handsome&quot;
c1.mom_look()     # β†’ &quot;pretty&quot;

# child2 κ°μ²΄ μƒμ„± λ° μ¤λ²„λΌμ΄λ”©λ λ©”μ†λ“ νΈμ¶
c2 = child2()
c2.doYouKonw(&quot;python&quot;)  # β†’ &quot;I love python&quot;</code></pre>
<hr />
<h3 id="β…-μ”μ•½-1">β… μ”μ•½</h3>
<ul>
<li><code>child1</code>μ€ <code>dad</code>μ™€ <code>mom</code>μ κΈ°λ¥μ„ λ¨λ‘ μƒμ†</li>
<li><code>child2</code>λ” <code>dad</code>μ <code>doYouKonw()</code> λ©”μ„λ“λ¥Ό <strong>μ¤λ²„λΌμ΄λ”©</strong>ν•μ—¬ μƒλ΅ μ •μ</li>
<li><strong>λ‹¤μ¤‘ μƒμ†</strong>, <strong>λ©”μ„λ“ μ¤λ²„λΌμ΄λ”©</strong>μ κµ¬μ΅°μ™€ λ™μ‘ ν™•μΈ μμ </li>
</ul>
<hr />
<h1 id="μ“°λ λ“-μ΄μ©ν•-μ±„ν…-ν”„λ΅κ·Έλ¨-1">μ“°λ λ“ μ΄μ©ν• μ±„ν… ν”„λ΅κ·Έλ¨ 1</h1>
<h2 id="π–¥οΈ-server-thread_serverpy">π–¥οΈ Server (<code>thread_server.py</code>)</h2>
<pre><code class="language-python">import socket
import threading

# μμ‹  μ²λ¦¬ ν•¨μ (ν΄λΌμ΄μ–ΈνΈλ³„λ΅ μ‹¤ν–‰λ  μ¤λ λ“ ν•¨μ)
def thread_recv(client_socket, addr):
    while True:
        recv_data = client_socket.recv(1024)
        print(f&quot;{addr}μ—μ„ λ°›μ€ λ©”μ‹μ§€ : {recv_data.decode()}&quot;)

        # λ°›μ€ λ°μ΄ν„°λ¥Ό λ‹¤μ‹ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅ (μ—μ½”)
        client_socket.sendall(recv_data)

        # &quot;end&quot; μμ‹  μ‹ μ—°κ²° μΆ…λ£
        if recv_data.decode() == &quot;end&quot;:
            print(f&quot;{addr}μ μ ‘μ†μ„ μΆ…λ£ν•©λ‹λ‹¤.&quot;)
            client_socket.close()
            break

# 1. μ†μΌ“ μƒμ„± λ° λ°”μΈλ”©
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.bind((&quot;&quot;, 9999))
sock.listen()
print(&quot;The echo server start.....&quot;)

# 2. ν΄λΌμ΄μ–ΈνΈ μ ‘μ† λ€κΈ° λ° μ²λ¦¬
while True:
    conn, addr = sock.accept()
    print(f&quot;{addr} μ—°κ²°λ¨&quot;)

    # ν΄λΌμ΄μ–ΈνΈλ§λ‹¤ λ³„λ„ μ¤λ λ“ μƒμ„±
    recv_handler = threading.Thread(target=thread_recv, args=(conn, addr))
    recv_handler.start()</code></pre>
<hr />
<h2 id="π’»-client-thread_clientpy">π’» Client (<code>thread_client.py</code>)</h2>
<pre><code class="language-python">import socket
import threading
import time

# μ†΅μ‹  μ“°λ λ“ ν•¨μ
def send_thread(sock):
    while True:
        send_data = input(&quot;μ…λ ¥: &quot;)
        sock.sendall(bytes(send_data, &quot;utf-8&quot;))

        if send_data == &quot;end&quot;:
            print(&quot;μ„λ²„μ— μΆ…λ£ μ”μ²­ λ³΄λƒ„&quot;)
            break

        time.sleep(0.3)  # μ•½κ°„μ λ”λ μ΄ (μμ‹  μ „μ— λ°λ³µ λ°©μ§€)

# μμ‹  μ“°λ λ“ ν•¨μ
def recv_thread(sock):
    while True:
        recv_data = sock.recv(1024)
        print(f&quot;recv : {recv_data.decode()}&quot;)

        if recv_data.decode() == &quot;end&quot;:
            print(&quot;μ„λ²„μ—μ„ μΆ…λ£ μ‘λ‹µ λ°›μ&quot;)
            break

# 1. μ†μΌ“ μƒμ„± λ° μ„λ²„ μ ‘μ†
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((&quot;127.0.0.1&quot;, 9999))

# 2. μ†΅μ‹ /μμ‹  μ“°λ λ“ λ™μ‹ μ‹¤ν–‰
sth = threading.Thread(target=send_thread, args=(sock,))
rth = threading.Thread(target=recv_thread, args=(sock,))
sth.start()
rth.start()</code></pre>
<hr />
<h3 id="β…-ν•µμ‹¬-μ •λ¦¬">β… ν•µμ‹¬ μ •λ¦¬</h3>
<table>
<thead>
<tr>
<th>ν•­λ©</th>
<th>μ„¤λ…</th>
</tr>
</thead>
<tbody><tr>
<td><strong>μ„λ²„</strong></td>
<td>μ ‘μ†ν• ν΄λΌμ΄μ–ΈνΈλ§λ‹¤ <code>thread_recv()</code> μ“°λ λ“ μƒμ„±, μ—μ½” μ²λ¦¬</td>
</tr>
<tr>
<td><strong>ν΄λΌμ΄μ–ΈνΈ</strong></td>
<td>μ†΅μ‹ κ³Ό μμ‹ μ„ κ°κ° λ³„λ„μ μ“°λ λ“λ΅ μ²λ¦¬ν•΄ <strong>λ™μ‹ ν†µμ‹  κ°€λ¥</strong></td>
</tr>
<tr>
<td><strong>&quot;end&quot;</strong></td>
<td>μΆ…λ£ μ‹ νΈ μ—­ν•  β€“ μ „μ†΅λλ©΄ ν•΄λ‹Ή μ“°λ λ“ μΆ…λ£ λ° μ†μΌ“ λ‹«ν</td>
</tr>
</tbody></table>
<hr />
<h1 id="μ“°λ λ“-μ΄μ©ν•-μ±„ν…-ν”„λ΅κ·Έλ¨-2">μ“°λ λ“ μ΄μ©ν• μ±„ν… ν”„λ΅κ·Έλ¨ 2</h1>
<hr />
<h2 id="β…-μ „μ²΄-μ„λ²„-μ½”λ“-thread_server2py">β… μ „μ²΄ μ„λ²„ μ½”λ“ (<code>thread_server2.py</code>)</h2>
<pre><code class="language-python">import socket
import threading
import os

numClient = 0  # ν„μ¬ μ ‘μ† ν΄λΌμ΄μ–ΈνΈ μ

# ν΄λΌμ΄μ–ΈνΈ μμ‹  μ²λ¦¬μ© μ¤λ λ“ ν•¨μ
def thread_recv(client_socket, addr):
    global numClient

    while True:
        recv_data = client_socket.recv(1024)

        # μ–΄λ–¤ μ¤λ λ“(ν΄λΌμ΄μ–ΈνΈ)μΈμ§€ ν™•μΈ
        print(f&quot;Thread Name [{threading.current_thread().name}]μ—μ„ λ³΄λ‚Έ λ©”μ‹μ§€ : {recv_data.decode()}&quot;)

        # 'end' μμ‹  μ‹ μ—°κ²° μΆ…λ£
        if recv_data.decode() == &quot;end&quot;:
            numClient -= 1
            print(f&quot;{addr}μ μ ‘μ†μ„ μΆ…λ£ν•©λ‹λ‹¤.&quot;)
            print(f&quot;ν„μ¬ μ„λ²„μ— μ ‘μ†λ ν΄λΌμ΄μ–ΈνΈ μ : {numClient}&quot;)
            client_socket.close()

            # λ¨λ“  ν΄λΌμ΄μ–ΈνΈ μ ‘μ† μΆ…λ£ μ‹ μ„λ²„λ„ μΆ…λ£
            if numClient == 0:
                print(&quot;μ„λ²„λ¥Ό μΆ…λ£ν•©λ‹λ‹¤.&quot;)
                os._exit(0)
            break

        # μ—μ½” λ©”μ‹μ§€ μ „μ†΅
        client_socket.sendall(recv_data)

# =========================
# λ©”μΈ μ„λ²„ μ½”λ“ μ‹μ‘ λ¶€λ¶„
# =========================

# 1. μ†μΌ“ μƒμ„±
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# 2. λ°”μΈλ”©
sock.bind((&quot;&quot;, 9999))

# 3. ν΄λΌμ΄μ–ΈνΈ μ ‘μ† λ€κΈ°
sock.listen()
print(&quot;The echo server start.....&quot;)

# 4. μ ‘μ† μλ½ λ° μ¤λ λ“ μƒμ„± λ°λ³µ
while True:
    conn, addr = sock.accept()

    numClient += 1  # μ ‘μ†μ μ μ¦κ°€
    print(f&quot;ν„μ¬ {addr}μ΄ μ ‘μ†ν–μµλ‹λ‹¤.&quot;)
    print(f&quot;ν„μ¬ μ„λ²„μ— μ ‘μ†λ ν΄λΌμ΄μ–ΈνΈ μ : {numClient}&quot;)

    # ν΄λΌμ΄μ–ΈνΈλ§λ‹¤ λ³„λ„ μ¤λ λ“λ΅ μμ‹  μ²λ¦¬
    recv_handler = threading.Thread(target=thread_recv, args=(conn, addr), name=str(addr))
    recv_handler.start()</code></pre>
<hr />
<h3 id="β…-ν•µμ‹¬-μ”μ•½">β… ν•µμ‹¬ μ”μ•½</h3>
<table>
<thead>
<tr>
<th>ν•­λ©</th>
<th>μ„¤λ…</th>
</tr>
</thead>
<tbody><tr>
<td><code>thread_recv()</code></td>
<td>κ° ν΄λΌμ΄μ–ΈνΈ ν†µμ‹ μ„ λ‹΄λ‹Ήν•  μ“°λ λ“ ν•¨μ</td>
</tr>
<tr>
<td><code>recv_handler = threading.Thread(...)</code></td>
<td>ν΄λΌμ΄μ–ΈνΈλ§λ‹¤ λ…λ¦½ μ“°λ λ“ μƒμ„±</td>
</tr>
<tr>
<td><code>name=addr</code></td>
<td>μ¤λ λ“ μ΄λ¦„μ„ μ ‘μ† μ£Όμ†λ΅ μ„¤μ •ν•΄ μ¶”μ  κ°€λ¥</td>
</tr>
<tr>
<td><code>os._exit(0)</code></td>
<td>λ¨λ“  μ ‘μ† μΆ…λ£ μ‹ μ„λ²„ κ°•μ  μΆ…λ£</td>
</tr>
</tbody></table>
<hr />
<h1 id="λΌμ΄λΈλ¬λ¦¬λ¥Ό-μ΄μ©ν•-μ±„ν…-ν”„λ΅κ·Έλ¨--μ—μ½”-μ„λ²„">λΌμ΄λΈλ¬λ¦¬λ¥Ό μ΄μ©ν• μ±„ν… ν”„λ΅κ·Έλ¨ β€“ μ—μ½” μ„λ²„</h1>
<p>μ•„λλ” μ—…λ΅λ“ν• λ‘ μ΄λ―Έμ§€λ¥Ό ν†µν•©ν•μ—¬ <code>chat_server2.py</code> μ „μ²΄ μ½”λ“λ¥Ό μ™„μ „ν•κ² μ •λ¦¬ν•κ³  μ£Όμ„μ„ λ§λ¶™μΈ λ²„μ „μ…λ‹λ‹¤:</p>
<hr />
<h2 id="β…-λ©€ν‹°-μ μ €-μ±„ν…-μ„λ²„-chat_server2py">β… λ©€ν‹° μ μ € μ±„ν… μ„λ²„ (chat_server2.py)</h2>
<pre><code class="language-python">import socketserver  # κ³ μμ¤€ TCP μ„λ²„ κµ¬μ¶•μ© λ¨λ“

# =============================
# β–¶ μ‚¬μ©μ κ΄€λ¦¬μ© ν•Έλ“¤λ¬ ν΄λμ¤
# =============================
class MyHandler(socketserver.BaseRequestHandler):
    users = {}  # {username: (socket, addr)} ν•νƒλ΅ μ‚¬μ©μ μ •λ³΄ μ €μ¥

    # μ „μ²΄ μ‚¬μ©μμ—κ² λ©”μ‹μ§€ μ „μ†΅
    def broadcast(self, msg):
        for sock, addr in self.users.values():
            sock.send(msg.encode())  # λ¬Έμμ—΄ β†’ λ°”μ΄νΈλ΅ μ „μ†΅

    # μ‚¬μ©μ λ“±λ΅
    def addUser(self, username, conn, addr):
        if username in self.users:
            conn.send(&quot;μ΄λ―Έ λ“±λ΅λμ–΄ μμµλ‹λ‹¤.\n&quot;.encode())
            return None

        self.users[username] = (conn, addr)  # λ“±λ΅
        self.broadcast(&quot;β…{}λ‹μ΄ μ°Έμ—¬ν–μµλ‹λ‹¤.\n&quot;.format(username))
        print(&quot;μ±„ν… μ°Έμ—¬ μΈμ› {}λ…&quot;.format(len(self.users)))
        return username

    # μ‚¬μ©μ μ κ±°
    def delUser(self, username):
        del self.users[username]
        self.broadcast(&quot;β…{}λ‹μ΄ ν‡΄μ¥ν–μµλ‹λ‹¤.\n&quot;.format(username))
        print(&quot;μ±„ν… μ°Έμ—¬ μΈμ› {}λ…&quot;.format(len(self.users)))

    # =============================
    # β–¶ ν΄λΌμ΄μ–ΈνΈ ν†µμ‹  μ²λ¦¬ ν•¨μ
    # =============================
    def handle(self):
        print(self.client_address[0])  # μ ‘μ† IP μ¶λ ¥

        # μ‚¬μ©μ μ΄λ¦„ λ“±λ΅ λ£¨ν”„
        while True:
            self.request.send(&quot;μ΄λ¦„μ„ μ…λ ¥ν•μ„Έμ”: &quot;.encode())
            username = self.request.recv(1024).decode()

            if self.addUser(username, self.request, self.client_address):
                break  # λ“±λ΅ μ„±κ³µ μ‹ νƒμ¶

        # μ±„ν… λ©”μ‹μ§€ μμ‹ /μ†΅μ‹  λ£¨ν”„
        while True:
            data = self.request.recv(1024)
            print(&quot;[{}] {}&quot;.format(username, data.decode()))

            if data.decode() == &quot;end&quot;:
                self.request.close()
                break

            self.broadcast(&quot;[{}] {}\n&quot;.format(username, data.decode()))

        print(&quot;[{}] μ ‘μ† μΆ…λ£&quot;.format(username))
        self.delUser(username)

# =============================
# β–¶ μ“°λ λ“ κΈ°λ° TCP μ„λ²„ ν΄λμ¤
# =============================
class ChatServer(socketserver.ThreadingMixIn, socketserver.TCPServer):
    pass

# =============================
# β–¶ μ„λ²„ μ‹¤ν–‰
# =============================
print(&quot;chat server start...&quot;)

chat_serv = ChatServer((&quot;&quot;, 9999), MyHandler)
chat_serv.serve_forever()      # μ„λ²„ μ‹¤ν–‰
chat_serv.shutdown()           # μ„λ²„ μ¤‘λ‹¨ μ”μ²­ μ‹
chat_serv.server_close()       # μ†μΌ“ μμ› ν•΄μ </code></pre>
<hr />
<h2 id="β…-μ‘λ™-κµ¬μ΅°-μ”μ•½">β… μ‘λ™ κµ¬μ΅° μ”μ•½</h2>
<table>
<thead>
<tr>
<th>κµ¬μ„± μ”μ†</th>
<th>μ„¤λ…</th>
</tr>
</thead>
<tbody><tr>
<td><code>MyHandler</code></td>
<td>ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ μ²λ¦¬ν•λ” ν΄λμ¤</td>
</tr>
<tr>
<td><code>users</code> λ”•μ…”λ„λ¦¬</td>
<td>μ ‘μ†ν• λ¨λ“  μ μ €μ μ†μΌ“, μ£Όμ† μ •λ³΄ μ €μ¥</td>
</tr>
<tr>
<td><code>broadcast()</code></td>
<td>λ¨λ“  μ μ €μ—κ² λ©”μ‹μ§€ μ „μ†΅</td>
</tr>
<tr>
<td><code>addUser()</code> / <code>delUser()</code></td>
<td>μ μ € λ“±λ΅ λ° μ‚­μ  κ΄€λ¦¬</td>
</tr>
<tr>
<td><code>handle()</code></td>
<td>ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μ‹ μ‹¤ν–‰, μ΄λ¦„ λ°›κ³  μ±„ν… μ²λ¦¬</td>
</tr>
<tr>
<td><code>ChatServer</code></td>
<td><code>ThreadingMixIn</code> μƒμ† β†’ λ‹¤μ¤‘ μ ‘μ† μ²λ¦¬ κ°€λ¥</td>
</tr>
</tbody></table>
<hr />